{
    "action": "update_account",
    "param": [
        {
            "name": "account_id",
            "mandatory": true
        },
        {
            "name": "account_name",
            "mandatory": false
        },
        {
            "name": "account_role",
            "mandatory": false
        },
        {
            "name": "account_email",
            "mandatory": false
        },
        {
            "name": "account_username",
            "mandatory": false
        },
        {
            "name": "account_password_new",
            "mandatory": false
        },
        {
            "name": "account_password_old",
            "mandatory": false
        }
    ],
    "process": [
      {"type":"declare_variable"
      ,"body":{"var_name":"hasil_api"}}
      ,{
        "type": "condition"
        ,"from_engine": false
        ,"id":null
        ,"check_condition": [
          {
            "check":{
            "var_name": "current_account"},"operator":"!=","value":{
            "var_name": "null","var_type":"hardcode"}
          }
        ]
        ,"ontrue":{
          "process": [
          ]
        }
      }
      ,{
            "type": "table",
            "from_engine": false,
            "runifnotnull": [],
            "table_name": "tb_account",
            "process_name": "select",
            "execute": "one",
            "param": [
                {
                    "var_name": "param_api_account_id"
                }
            ],
            "array_data": [
                "id",
                "username",
                "password"
            ],
            "where": [
                {
                    "index": "id",
                    "operator": "=",
                    "value": {
                        "var_name": "param_api_account_id"
                    }
                }
            ],
            "outputVariable": "current_account",
            "engine": []
        }
        ,
        {
          "type": "condition"
          ,"from_engine": false
          ,"id":null
          ,"check_condition": [
            {
              "check":{
              "var_name": "current_account"},"operator":"!=","value":{
              "var_name": "null","var_type":"hardcode"}
            }
          ]
          ,"ontrue":{
            "process": [
              {
                "type": "condition"
                ,"from_engine": false
                ,"id":null
                ,"check_condition": [
                  {
                    "check":{
                    "var_name": "param_api_account_name"},"operator":"!=","value":{
                    "var_name": "null","var_type":"hardcode"}
                  }
                ]
                ,"ontrue":{
                  "process": [

                    {
                        "type": "table",
                        "from_engine": false,
                        "runifnotnull": [],
                        "table_name": "tb_account",
                        "execute": "execute",
                        "process_name": "update",
                        "param": [
                            {
                                "var_name": "param_api_account_id"
                            },
                            {
                                "var_name": "param_api_account_name"
                            },
                            {
                                "var_name": "param_api_account_email"
                            },
                            {
                                "var_name": "param_api_account_role"
                            }
                        ],
                        "array_data": [
                            {
                                "index": "name",
                                "value": {
                                    "var_name": "param_api_account_name"
                                }
                            },
                            {
                                "index": "role",
                                "value": {
                                    "var_name": "param_api_account_role"
                                }
                            },
                            {
                                "index": "email",
                                "value": {
                                    "var_name": "param_api_account_email"
                                }
                            }
                        ],
                        "where": [
                            {
                                "index": "id",
                                "operator": "=",
                                "value": {
                                    "var_name": "param_api_account_id"
                                }
                            }
                        ],
                        "outputVariable": "hasil_updatedata_account"
                    }
                    ,{"type":"set_variable"
                    ,"var":{"var_name":"hasil_api"},"equal":{"var_name":"hasil_updatedata_account"}}

                  ]
                }
              }
              ,{
                "type": "condition"
                ,"from_engine": false
                ,"id":null
                ,"check_condition": [
                  {
                    "check":{
                    "var_name": "param_api_account_password_new"},"operator":"!=","value":{
                    "var_name": "null","var_type":"hardcode"}
                  }
                ]
                ,"ontrue":{
                  "process": [
                    {"type":"encrypt_sha256",
                    "from":{"var_name":"param_api_account_password_old"}
                  ,"outputVariable":"kuncianpassword"}
                    ,{"type":"encrypt_sha256",
                    "from":{"var_name":"param_api_account_password_new"}
                  ,"outputVariable":"kuncianpasswordbaru"}
                    ,{
                          "type": "table",
                          "from_engine": false,
                          "runifnotnull": [],
                          "table_name": "tb_account",
                          "process_name": "select",
                          "execute": "one",
                          "param": [
                              {
                                  "var_name": "kuncianpassword"
                              }
                          ],
                          "array_data": [
                              "password"
                          ],
                          "where": [
                              {
                                  "index": "password",
                                  "operator": "=",
                                  "value": {
                                      "var_name": "kuncianpassword"
                                  }
                              }
                          ],
                          "outputVariable": "check_password",
                          "engine": []
                      }
                      ,{
                        "type": "condition"
                        ,"from_engine": false
                        ,"id":null
                        ,"check_condition": [
                          {
                            "check":{
                            "var_name": "check_password"},"operator":"!=","value":{
                            "var_name": "null","var_type":"hardcode"}
                          }
                        ]
                        ,"ontrue":{
                          "process": [
                            {
                                "type": "table",
                                "from_engine": false,
                                "runifnotnull": [],
                                "table_name": "tb_account",
                                "execute": "execute",
                                "process_name": "update",
                                "param": [
                                    {
                                        "var_name": "param_api_account_id"
                                    },
                                    {
                                        "var_name": "kuncianpasswordbaru"
                                    }
                                ],
                                "array_data": [
                                    {
                                        "index": "password",
                                        "value": {
                                            "var_name": "kuncianpasswordbaru"
                                        }
                                    }
                                ],
                                "where": [
                                    {
                                        "index": "id",
                                        "operator": "=",
                                        "value": {
                                            "var_name": "param_api_account_id"
                                        }
                                    }
                                ],
                                "outputVariable": "hasil_updatedata_account_password"
                            }
                            ,{"type":"set_variable"
                            ,"var":{"var_name":"hasil_api"},"equal":{"var_name":"hasil_updatedata_account_password"}}

                          ]
                        }
                      }
                  ]
                }
              }
            ]
          }
        }
    ],
    "engine": [],
    "response_output": "v{'var_name':'hasil_api'}v",
    "response_type": "text",
    "returnpackage": {}
}
